# 就算是萝莉控也能看懂的Linux身份管理文件
## `/etc/passwd`
`passwd` 文件是一个配置用户账号的文件，它记录了系统中所有用户的相关信息。每个用户的信息占据文件的一行，各个字段使用冒号 `:` 分隔。虽然文件名为 `passwd` 但是该文件中通常并未存储密码

默认该文件是没有写入权限，通常不需要手动修改。如果需要修改，可以使用 `vipw` 命令以确保安全

该文件内容通常如下
![](/img/身份管理/00.png)

以其中 `root` 为例
```ruby
root:x:0:0:root:/root:/usr/bin/zsh
```
每列含义如下

|列数|意义|示例|说明|
|:---:|:---:|:---:|:---:|
|1|用户名|`root`|用户登录名，用于用户登录系统
|2|密码字段|`x`|占位符 x，通常实际密码存储在 `/etc/shadow` 文件中，无法直接从 `/etc/passwd` 获取密码
|3|用户ID (UID)|`0`|系统内部标识用户，`0` 是 `root` 用户的 UID，`1-999` 通常保留给系统用户，`1000` 及以上为普通用户
|4|用户组ID (GID)|`0`|系统内部标识用户所属的组，`0` 是 `root` 组的 GID
|5|用户描述信息|`root`|用户的描述信息，并不重要，普通用户默认为空
|6|用户主目录|`/root`|用户的主目录，用户登录后进入的默认目录
|7|用户默认 `shell`|`/usr/bin/zsh`|	用户登录时启动的命令解释器，如果为 /usr/sbin/nologin 或 /bin/false 则表示该用户无法登录系统

## `/etc/shadow`
`shadow` 文件是一个存储加密用户密码和其他密码相关信息的文件。它增强了系统的安全性，通过将密码信息从 `/etc/passwd` 文件中移出，使得普通用户无法读取密码字段。同样每个用户的信息占据文件的一行，各个字段使用冒号 `:` 分隔

默认该文件是没有写入权限，通常不需要手动修改。如果需要修改，可以使用 `vipw -s` 命令以确保安全

该文件内容通常如下
![](/img/身份管理/10.png)

以其中 `root` 为例
```ruby
root:$y$j9T$fYi6yTzSnRBVp1dqUCOCL0$agjF.2bwmAH8SxttNtLvyekXcPfdyLCkX/LT/aksx14:19920:0:99999:7:::
```
每列含义如下

|列数|意义|示例|说明|
|:---:|:---:|:---:|:---:|
|1|用户名|`root`|用户名，与 `/etc/passwd` 文件中的用户名对应
|2|密码|`$y$...`|哈希后的密码。`$1$` 表示 `MD5` 哈希；`$5$` 表示 `SHA-256` 哈希；`$6$` 表示 `SHA-512` 哈希；`$y$` 表示 `yescrypt` 哈希；`*` 表示用户账号已禁用，无法登录;空密码字段表示没有密码
|3|最近更改密码时间|`19920`|`date -d '1970-01-01 + 19920 days'`即 `2024-07-16`更改过密码
|4|最小时间间隔|`0`|两次更改密码之间的最小间隔天数，单位为天，为 `0` 表示随时可以更改密码
|5|最大时间间隔|`99999`|两次更改密码之间的最大间隔天数，单位为天，`99999` 天内必须修改一次密码
|6|警告时间|`7`|在密码过期前 `7` 天开始警告用户
|7|密码过期多少天后禁用账号|`空`|为空则不禁用账号
|8|过期时间|`空`|为空则永不过期，计算方式同 `最近更改密码时间` ，`1970-01-01` 后多少天
|9|标志字段|`空`|保留字段，目前未使用


## `/etc/group`
/etc/group 文件是一个包含系统用户组信息的文件，用于定义系统中各个用户组及其相关属性。每行记录一个用户组的信息，各个字段使用冒号`:`分隔，基本同 `/etc/passwd`

该文件内容通常如下
![](/img/身份管理/20.png)
以`root`组为例
```ruby
root:x:0:
```
每列含义如下

|列数|意义|示例|说明|
|:---:|:---:|:---:|:---:|
|1|组名|`root`|组名，用于标识用户组
|2|组密码|`x`|存储组密码的加密形式，通常为 x 表示密码存储在 `/etc/gshadow` 文件中，一般情况使用不到
|3|`GID (组 ID)`|0|系统内部用来标识用户组的唯一 ID，0 是 root 组的 GID
|4|成员列表|`空`|属于该组的用户列表，逗号分隔


<script src="/js/menu.js"></script>